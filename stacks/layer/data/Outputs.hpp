// ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// Pragma.
// ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#pragma once

// ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// Neural Networks Experiment.
// ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
namespace sx
{
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// Expand namespaces.
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	using namespace fx;

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// Layer data: Output buffers.
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	template<class T, uMAX SZ_OUT, uMAX SZ_GRAD, bool HAS_RAW = true>
	struct LDOutputs
	{
		alignas(ALIGNMENT) T OutTrans[SZ_OUT];
		alignas(ALIGNMENT) T OutRaw[SZ_OUT];
		alignas(ALIGNMENT) T Gradient[SZ_GRAD];

		LDOutputs ( void ) : OutTrans{}, OutRaw{}, Gradient{} {}
	};

	template<class T, uMAX SZ_OUT, uMAX SZ_GRAD>
	struct LDOutputs<T, SZ_OUT, SZ_GRAD, false>
	{
		alignas(ALIGNMENT) T OutTrans[SZ_OUT];
		alignas(ALIGNMENT) T Gradient[SZ_GRAD];

		LDOutputs ( void ) : OutTrans{}, Gradient{} {}
	};
}
